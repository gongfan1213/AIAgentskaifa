### 第2章 使用Coze打造专属Agent
#### 2.1 Coze平台
##### 2.1.1 Coze平台的优势
Coze（扣子）平台是由字节跳动公司打造的一个创新的AI应用和客服聊天机器人开发平台，可以理解为字节跳动版的GPTs。它致力于为用户提供一款简单易用的工具，使其创建和部署各种类型的客服聊天机器人变得轻松便捷。以下是Coze平台的核心优势，这些优势共同构成了其在AI开发领域中的独特地位。

1. **低门槛用户体验**

Coze平台的设计理念是简化客服聊天机器人的创建和部署过程，使其对没有编程背景的用户同样友好。这一理念贯穿于平台的每个环节，以确保用户能够轻松上手，快速实现自己的想法。

2. **丰富的插件生态系统**

Coze平台提供了60多种不同的插件，覆盖了新闻阅读、旅行规划、生产力工具等多个领域。这些插件极大地拓展了客服聊天机器人的能力边界，为用户提供了广泛的应用可能性，同时强大的自定义插件支持将私有API集成为插件。

3. **强大的知识库**

Coze提供了简单易用的知识库能力，能让AI Bot（人工智能机器人）与用户自己的数据（如PDF文档、网页文本）进行交互。用户可以在知识库中存储和管理数据，让AI Bot来使用相关的知识。

4. **快速生成AI Bot**

Coze平台支持30秒无代码生成AI Bot，这一功能意味着用户可以迅速搭建起客服聊天机器人的基本框架，而无须深入了解复杂的编程知识。这不仅提高了开发效率，还降低了技术门槛。

5. **广泛的应用场景**

Coze平台的应用不仅限于创建客服聊天机器人，它同样适用于开发基于AI模型的问答机器人。这些机器人能够处理从简单的问答到复杂逻辑对话的各种需求。

6. **强大的数据管理、长期记忆和定时任务功能**

Coze平台提供了一个方便与AI交互的长期记忆功能，通过这个功能，可以让AI Bot持久地记住用户与它对话的重要参数或内容，也可以让AI Bot记住用户的饮食偏好、语言偏好等信息，从而提高用户体验。Coze平台还支持定时任务功能，让AI Bot主动和用户进行对话。读者是否希望AI Bot能主动给你发送消息？通过定时任务功能，Coze平台可以非常简单地通过自然语言创建各种复杂的定时任务，AI Bot会准时给用户发送对应的消息内容。例如，用户可以让AI Bot每天早上推荐个性化的新闻，或者每周五规划周末的出行计划。

7. **背靠字节跳动的流量优势**

作为字节跳动公司推出的产品，Coze平台在流量获取上具有显著优势。这对希望通过AI应用吸引用户的开发者来说，无疑会产生一个巨大的吸引力。



综上所述，Coze平台以其低门槛、高效率和强大的功能集，为用户和开发者提供了一个极具吸引力的AI应用开发环境。无论是个人爱好者还是专业开发者，都能在这个平台上找到适合自己的工具和资源，轻松创建和部署各类AI应用。



##### 2.1.2 Coze平台的界面

1. **主界面**

成功登录Coze平台后进入图2-1所示的主界面。

![image](https://github.com/user-attachments/assets/7650893b-45c9-452c-a44b-d837272f8b3a)



我们可以通过“扣子助手”询问问题，比如，“Coze是什么？如何使用Coze？”，结果如图2-2所示。

2. **“个人空间”界面**

选择主界面左侧的“个人空间”选项，进入“个人空间”界面，即个人界面，如图2-3所示，该界面中会保留用户创建的Bots、插件、工作流等。

![image](https://github.com/user-attachments/assets/4c2d7c21-3363-4685-9032-f54b12f14457)


3. **“Bot商店”界面**

![image](https://github.com/user-attachments/assets/14fa44d7-3571-4f83-bb41-867bc3d5d42b)

![image](https://github.com/user-attachments/assets/d96cec74-6a4a-4849-bdd7-7998bb7165b2)


选择主界面左侧的“Bot商店”选项，进入“Bot商店”界面，在该界面中可以看到其他用户发布的Bot和主题，并可以对其进行下载和使用，如图2-4所示。

4. **“插件”界面**

![image](https://github.com/user-attachments/assets/4851db4c-1d7c-4f79-b4c2-d6999156632c)


选择主界面左侧的“插件商店”选项，进入“插件”界面，如图2-5所示，该界面中包括其他用户发布的插件，用户可以在创建自己的Bot时下载和引用这些插件，以丰富自己的Bot功能。



##### 2.1.3 Coze平台的功能模块

1. **创建和发布Bot**

创建过程包括填写Bot信息、编写提示词、添加插件、配置工作流和知识库、设置开场白、预览调试等。用户可以在Coze平台上快速搭建基于AI模型的各类问答Bot，并将其发布到多个社交平台或通信软件上。

2. **插件系统**

Coze平台提供了60多种不同的插件，包括新闻阅读、旅行计划、生产力工具、图像理解API和多模态模型等。这些插件可以方便地调用特定的API完成特定功能，减少了大量导入API的操作，降低了非专业开发者的开发门槛。

3. **知识库**

Coze平台拥有强大的知识库功能，可以“学习”PDF文档、网页文本和Excel数据，并通过“理解”和“应用”这些数据来服务用户。

4. **低代码开发**

Coze平台支持便捷的图形用户界面点选式及数据库可用性组拖曳式交互功能，并提供了丰富的组件库及工作流编排能力，可以使用户快速搭建基于AI模型的各类问答Bot。

5. **附加服务**

除了基本功能，Coze平台还提供了一系列的附加服务，如额外的Bot交互次数购买、专业的插件开发、数据分析服务等。这些服务可以单独购买，也可以作为套餐的一部分。

6. **多平台发布**

用户可以将创建的AI Bot发布到多个平台上，如豆包、微信客服、微信订阅号、微信服务号、飞书等。


#### 2.2 Agent的实现流程

##### 2.2.1 Agent需求分析

Agent需求分析是构建Agent系统的第一步，旨在明确软件功能和需求。这一阶段通常包括以下几个关键步骤。

（1）**收集需求**：开发者需要与用户进行深入交流，了解他们的具体需求和期望。这些需求可能涉及系统的功能、性能指标、用户界面等方面。

（2）**定义角色和职责**：将系统视为由不同角色组成的一个组织，并明确每个角色的职责和权限。这有助于在后续的设计和开发过程中保持清晰的结构。

（3）**建立领域模型**：通过定义各种关联和概念集，建立一个完整的领域模型。这一步对于理解和实现复杂的业务逻辑至关重要。

（4）**优化问题研究**：在需求分析过程中，识别并研究潜在的优化问题，以确保最终产品能够高效地满足用户需求。

（5）**可视化需求分析环境**：利用基于网格的可视化工具来辅助需求分析，有助于开发者更直观地理解和管理复杂的需求。



##### 2.2.2 Agent架构设计

Agent架构设计是构建Agent系统的核心步骤，旨在定义Agent的交互模式和内部组件之间的连接。一个统一的框架通常包括以下几个关键模块。

（1）**Profile模块**：负责定义和管理Agent的基本属性，如身份、配置和行为策略。

（2）**Memory模块**：用于存储和管理Agent的知识库，支持Agent进行长期记忆和短期记忆的区分。

（3）**Planning模块**：负责制订行动计划，通过分解复杂任务，选择最佳路径来实现目标。

（4）**Action模块**：负责执行实际操作，通过调用外部API或生成代码来完成具体任务。



此外，进行Agent架构设计还需要考虑以下几个方面。

（1）**认知架构**：定义软件Agent或智能控制系统内部组件的组织结构和交互模式。

（2）**多Agent协作**：在多Agent系统的运作中，关键在于各个Agent之间的有效协作。为了确保在解决问题时能够遵循一种有条理的方法，可以采用标准操作规程。

（3）**迭代和对话式工作流**：与传统基于LLM的工作流程不同，Agent的工作流程具有更强的迭代性和对话式，这有助于其不断进行优化和改进。



通过以上步骤，可以构建出一个高效、可靠且灵活的Agent系统，使其能够满足复杂的业务需求。



#### 2.3 使用Coze平台打造专属的NBA新闻助手

##### 2.3.1 需求分析与设计思路制定

在使用Coze平台打造专属的NBA新闻助手之前，首先需要进行详细的需求分析和设计思路的制定。

1. **需求分析**

（1）明确NBA新闻助手的主要功能，如新闻推荐、分类汇总、实时更新等。

（2）确定目标用户群体，了解他们的需求和偏好。

（3）设定性能指标，如响应时间、准确性等。

2. **设计思路制定**

（1）设计插件的输入/输出接口，以确保数据能够被准确传输和处理。

（2）利用Coze平台提供的插件和功能（如知识库、长期记忆、工作流等），实现复杂的逻辑处理和任务自动化。

（3）设定Bot的身份（如NBA新闻播报员、分类汇总器等）及其要实现的目标和具备的技能。



##### 2.3.2 NBA新闻助手的实现与测试

在实现NBA新闻助手并进行测试时，可以参考以下步骤。

1. **创建Bot**

在“个人空间”界面中，单击右上角的“创建Bot”按钮，在弹出的“创建Bot”对话框中输入Bot名称和Bot功能介绍，并单击“AI生成”图标，完成Bot的创建，如图2-6所示。


![image](https://github.com/user-attachments/assets/297ebee9-908e-41e3-b9b7-072cb168a1aa)


1）**编写提示词**

编写提示词通常包括三步，如图2-7所示。

（1）设定角色。

（2）设定技能。

（3）设定限制内容。

![image](https://github.com/user-attachments/assets/c4166cab-77c8-4a94-b596-dd1de9c6aa17)


2）**添加插件**

在“添加插件”对话框中，单击左上角的“创建插件”按钮，创建自定义的插件，如图2-8所示。


![image](https://github.com/user-attachments/assets/8fbf96e4-e266-426c-9268-e30e308add5a)


![image](https://github.com/user-attachments/assets/e19e03c0-648b-4ee9-a2a2-41a8480d5f9c)



在弹出的“新建插件”对话框中填写插件名称和插件描述。在这里笔者创建了一个“我的技能包”插件，其主要任务是把自定义的技能归集到技能包里。在“插件URL”输入框中，填写接口的地址。这里为了方便，我们使用语聚AI的接口，如图2-9所示。

在图2-9的“授权方式”下拉列表中有三个选项：“不需要授权”、“Service”和“Oauth”。

（1）不需要授权：无任何认证环节、请求接口、接口返回值。

（2）Service：服务认证，该授权方式是指API通过密钥或令牌校验信息的合法性，也就是用户要向接口传递令牌信息，后端验证成功后才能返回值。

（3）Oauth：Oauth是一种常用于用户代理身份验证的标准，它允许第三方应用程序在不共享用户密码的情况下访问用户的特定资源。 
